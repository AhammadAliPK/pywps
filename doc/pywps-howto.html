<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Implementation of OGC's WPS standard: PyWPS</TITLE>
<META NAME="description" CONTENT="Implementation of OGC's WPS standard: PyWPS">
<META NAME="keywords" CONTENT="pywps-howto">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="pywps-howto.css">

</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive"
 SRC="/usr/share/latex2html/icons/nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev_g.png">   
<BR>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<H1 ALIGN="CENTER">Implementation of OGC's WPS standard: PyWPS</H1>
<DIV CLASS="author_info">

<P ALIGN="CENTER"><STRONG>Jachym Cepicky</STRONG></P>
</DIV>

<P>

<P><P>
<BR>
<BLOCKQUOTE>
Copyright &#169;2006 PyWPS Development Team
    Permission is granted to copy, distribute and/or modify this document
    under the terms of the GNU Free Documentation License, Version 1.2
    or any later version published by the Free Software Foundation;
    with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
    A copy of the license is included in the section entitled "GNU
    Free Documentation License".

</BLOCKQUOTE>

<P><P>
<BR>

<P>
In this file, you can found the description of installation and
configuration of PyWPS script. At the and, you can learn, how to add
your own process. This document describes most recent
version of PyWPS (<SPAN  CLASS="textit">2.0.0</SPAN>), available in subversion respository.

<P>
PyPWS project has been started on April 2006 with support of DBU -
Deutsche Bundesstiftung Umwelt<A NAME="tex2html1"
  HREF="#foot297"><SUP><SPAN CLASS="arabic">1</SPAN></SUP></A> and with help of
GDF-Hannover<A NAME="tex2html3"
  HREF="#foot298"><SUP><SPAN CLASS="arabic">2</SPAN></SUP></A> and Help Service Remote
Sensing<A NAME="tex2html5"
  HREF="#foot299"><SUP><SPAN CLASS="arabic">3</SPAN></SUP></A> companies. Initial author is Jachym
Cepicky<A NAME="tex2html7"
  HREF="#foot300"><SUP><SPAN CLASS="arabic">4</SPAN></SUP></A>.

<P>
<BR>

<H2><A NAME="SECTION00010000000000000000">
Contents</A>
</H2>
<!--Table of Contents-->

<UL CLASS="TofC">
<LI><A NAME="tex2html66"
  HREF="pywps-howto.html#SECTION00020000000000000000">Introduction</A>
<UL>
<LI><A NAME="tex2html67"
  HREF="pywps-howto.html#SECTION00021000000000000000">How it works</A>
</UL>
<BR>
<LI><A NAME="tex2html68"
  HREF="pywps-howto.html#SECTION00030000000000000000">Quick install</A>
<LI><A NAME="tex2html69"
  HREF="pywps-howto.html#SECTION00040000000000000000">Know issues</A>
<LI><A NAME="tex2html70"
  HREF="pywps-howto.html#SECTION00050000000000000000">Installation</A>
<UL>
<LI><A NAME="tex2html71"
  HREF="pywps-howto.html#SECTION00051000000000000000">Installation the quick 'n' dirty way</A>
<LI><A NAME="tex2html72"
  HREF="pywps-howto.html#SECTION00052000000000000000">Installation the 'clean' way</A>
</UL>
<BR>
<LI><A NAME="tex2html73"
  HREF="pywps-howto.html#SECTION00060000000000000000">Configuration</A>
<UL>
<LI><A NAME="tex2html74"
  HREF="pywps-howto.html#SECTION00061000000000000000">Main configuration file pywps/etc/settings.py</A>
<LI><A NAME="tex2html75"
  HREF="pywps-howto.html#SECTION00062000000000000000">etc/grass.py</A>
<LI><A NAME="tex2html76"
  HREF="pywps-howto.html#SECTION00063000000000000000">Testing after installation</A>
</UL>
<BR>
<LI><A NAME="tex2html77"
  HREF="pywps-howto.html#SECTION00070000000000000000">Add your own processes</A>
<UL>
<LI><A NAME="tex2html78"
  HREF="pywps-howto.html#SECTION00071000000000000000">Process initialization and configuration</A>
<LI><A NAME="tex2html79"
  HREF="pywps-howto.html#SECTION00072000000000000000">Process Programming</A>
<LI><A NAME="tex2html80"
  HREF="pywps-howto.html#SECTION00073000000000000000">GRASS specific notes</A>
</UL>
<BR>
<LI><A NAME="tex2html81"
  HREF="pywps-howto.html#SECTION00080000000000000000">Testing your new process</A>
<LI><A NAME="tex2html82"
  HREF="pywps-howto.html#SECTION00090000000000000000">Using PyWPS</A>
<UL>
<LI><A NAME="tex2html83"
  HREF="pywps-howto.html#SECTION00091000000000000000">Input</A>
<LI><A NAME="tex2html84"
  HREF="pywps-howto.html#SECTION00092000000000000000">Output</A>
</UL>
<BR>
<LI><A NAME="tex2html85"
  HREF="pywps-howto.html#SECTION000100000000000000000">Example process: addvalue</A>
<LI><A NAME="tex2html86"
  HREF="pywps-howto.html#SECTION000110000000000000000">KVP request encoding of addvalue</A>
<LI><A NAME="tex2html87"
  HREF="pywps-howto.html#SECTION000120000000000000000">XML request encoding addvalue</A>
</UL>
<!--End of Table of Contents-->
<P>

<P>

<H1><A NAME="SECTION00020000000000000000">
Introduction</A>
</H1>
PyWPS (Python Web Processing Service) is implementation of Web
Processing Service 0.4.0 standard from Open Geospatial
Consortium<A NAME="tex2html9"
  HREF="#foot301"><SUP><SPAN CLASS="arabic">5</SPAN></SUP></A>.

<P>
It has been started on Mai 2006 as project supported by DBU. It offers
environment for programming own process (geofunctions or models) which can
be accessed from the public. The main advantage of PyWPS is, that it has
been written with native support for GRASS
GIS<A NAME="tex2html11"
  HREF="#foot40"><SUP><SPAN CLASS="arabic">6</SPAN></SUP></A>. Access GRASS modules via web
interace should be as easy as possible.
However, not only GRASS GIS is supported. Usage of other programs, like
R package or GDAL or PROJ tools is possible as well.

<P>
PyWPS is written in Python programming language, your processes must use
this language too. 

<P>
PyWPS Homepage can be found at <TT><A NAME="tex2html12"
  HREF="http://pywps.wald.intevation.org">http://pywps.wald.intevation.org</A></TT>.
PyWPS Wiki is hosted on <TT><A NAME="tex2html13"
  HREF="http://pywps.ominiverdi.org/wiki">http://pywps.ominiverdi.org/wiki</A></TT>. 

<P>

<H2><A NAME="SECTION00021000000000000000">
How it works</A>
</H2>
PyWPS is an translator application between client (Web Browser, Desktop
GIS, command line tool, ...) and working tool installed on the server.
PyWPS does no work by it self. As working tool, GRASS GIS, GDAL, PROJ, R
and other programs can be used.

<P>

<DIV ALIGN="CENTER"><A NAME="pic:pywps"></A><A NAME="45"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 1:</STRONG>
How does PyWPS work: GRASS GIS is in this case working tool</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<IMG
  WIDTH="832" HEIGHT="275" ALIGN="BOTTOM" BORDER="0"
 SRC="./pywps-schema.png"
 ALT="Image pywps-schema">

</DIV></TD></TR>
</TABLE>
</DIV>

<P>

<H1><A NAME="SECTION00030000000000000000">
Quick install</A>
</H1>

<OL>
<LI>Install PyWPS, see page&nbsp;<A HREF="pywps-howto.html#install"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="/usr/share/latex2html/icons/crossref.png"></A> for details
</LI>
<LI>NOTE: Copy original files (process examples, configuration files)
    with <TT>.py-dist</TT> suffix to <TT>.py</TT>, when you see them.
</LI>
<LI>Edit configuration files in <TT>pywps/etc/</TT> directory. See
    page&nbsp;<A HREF="pywps-howto.html#configuration"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="/usr/share/latex2html/icons/crossref.png"></A> for details.
</LI>
<LI>Create or edit <TT>__init__.py</TT> file in
    <TT>pywps/processes</TT> directory. Add available process names to
    <TT>__all__</TT> structure.
</LI>
<LI>Add your processes to <TT>pywps/processes</TT> directory. See
    page&nbsp;<A HREF="pywps-howto.html#processes"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="/usr/share/latex2html/icons/crossref.png"></A> for details.
</LI>
<LI>Run PyWPS with <TT>./wps.py</TT> command, see
    page&nbsp;<A HREF="pywps-howto.html#testing"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="/usr/share/latex2html/icons/crossref.png"></A> for details.
</LI>
</OL>

<P>

<H1><A NAME="SECTION00040000000000000000">
Know issues</A>
</H1>
Known bugs and limitations to UL>
<LI>Sometimes, when there is e.g. SyntaxError in the process, teporary file <TT>/tmp/pywps*</TT> is not deleted, which ledts to <TT>ServerBussy</TT> exception and the files have to be removed by hand.
</LI>
<LI>If inputs are of type <TT>LiteralValue</TT> and it's type is
string, it is not controlled properly. Take care on your inputs and do
not use it directly in scripts to avoid your server to be hacked.
</LI>
</UL>

<P>
Please report all problems or unexpected handeling either via pywps mailing
list<A NAME="tex2html15"
  HREF="#foot302"><SUP><SPAN CLASS="arabic">7</SPAN></SUP></A>or using PyWPS
bugtracker<A NAME="tex2html16"
  HREF="#foot303"><SUP><SPAN CLASS="arabic">8</SPAN></SUP></A>.

<P>

<H1><A NAME="SECTION00050000000000000000"></A>
<A NAME="install"></A>
<BR>
Installation
</H1>   
Required packages:

<P>

<UL>
<LI>python 
</LI>
<LI>python-xml 
</LI>
</UL>

<P>
Recommended packages:

<P>

<UL>
<LI>Web Server (e.g. Apache) - <TT><A NAME="tex2html17"
  HREF="http://httpd.apache.org">http://httpd.apache.org</A></TT> -  You
    will need an web server, to be able to execute processes from remote
    computers.

<P>
</LI>
<LI>GIS GRASS  - <TT><A NAME="tex2html18"
  HREF="http://grass.itc.it">http://grass.itc.it</A></TT> - Geographical Resources
    Analysis Support System (GRASS) is Open Source GIS, which provides more
    then 350 modules for raster and vector (2D, 3D) data analysis. PyWPS is
    written with native support for GRASS and it's functions.

<P>
</LI>
<LI>PROJ.4  - <TT><A NAME="tex2html19"
  HREF="http://proj.maptools.org">http://proj.maptools.org</A></TT> - Cartographic
    Projections library used in various Open Source projects, such as
    GRASS, UMN MapServer, QGIS and others. It can be used e.g. for data
    transformation.

<P>
</LI>
<LI>GDAL/OGR  - <TT><A NAME="tex2html20"
  HREF="http://gdal.org">http://gdal.org</A></TT> - translator library for
    raster geospatial data formats, is used in various projects for
    importing, exporting and transformation between various raster and vector
    data formats.

<P>
</LI>
<LI>R  - <TT><A NAME="tex2html21"
  HREF="http://www.r-project.org">http://www.r-project.org</A></TT> - is a language and environment
    for statistical computing and graphics.

<P>
</LI>
</UL>

<P>

<H2><A NAME="SECTION00051000000000000000">
Installation the quick 'n' dirty way</A>
</H2>
For installing pywps to your server simply unzip the archive to the
directory, where cgi programs are allowed to run. You can also use current
repository version.

<P>
<PRE>
$ cd /usr/lib/cgi-bin/
$ tar xvzf /tmp/pywps-VERSION.tar.gz
$ pywps/wps.py
</PRE>

<P>

<H2><A NAME="SECTION00052000000000000000">
Installation the 'clean' way</A>
</H2>
Unzip the package 
<PRE>
$ tar -xzf pywps-VERSION.tar.gz
</PRE>
and run 
<PRE>
$ python setup.py install
</PRE> 

<P>
Several binary packages for Linux distributios are also avaliable on PyWPS
homepage<A NAME="tex2html22"
  HREF="#foot93"><SUP><SPAN CLASS="arabic">9</SPAN></SUP></A>.

<P>

<H1><A NAME="SECTION00060000000000000000"></A>
<A NAME="configuration"></A>
<BR>
Configuration
</H1>

<P>
Before you start to tune your PyWPS installation, you should get your copy of
OpenGIS(R) Web Processing Service document (OGC 05-007r4) version
0.4.0<A NAME="tex2html24"
  HREF="#foot304"><SUP><SPAN CLASS="arabic">10</SPAN></SUP></A>.

<P>

<P>
<BR>
NOTE: Note, that the configuration option are CASE SENSITIVE
<P>
<BR>


<P>
Pywps configuration takes places in two files. The files are actually python
scripts, so it does not harm, if you have some experience in python
programming language. But you should be able to setup the program without
any python knowledge.

<P>
The first file is in <TT>pywps/etc/settings.py</TT> and (optional) the second file is
<TT>pywps/etc/grass.py</TT> which has to be setuped if you do want to use
GRASS GIS modules in your scripts. Some special "tuning" can be done in
<TT>pywps/processes/__init__.py</TT>
file. You can allways obtain original configuration files from
<TT>pywps/Wps/default_settings.py</TT> and <TT>pywps/Wps/default_grass.py</TT>.

<P>

<H2><A NAME="SECTION00061000000000000000">
Main configuration file <TT>pywps/etc/settings.py</TT></A>
</H2>

<P>
This file has got two sections: WPS and serverSettings

<P>
In the <TT>WPS</TT> section, the main configuration is set, which appears mostly in
GetCapabilities request. The <SPAN  CLASS="textit">mandatory</SPAN> parameters, which should be set up
are (with default/recommend values):

<P>
<PRE>
WPS = {
    'version': "0.4.0",
    'encoding': "utf-8",
    'ServiceIdentification': {
        'Title':"Jachym's WPS server",
        'ServiceType':"WPS",
        'ServiceTypeVersion':"0.1.0",
        'Abstract':'Abstract to this WPS',
    },
    'ServiceProvider': {
            'ProviderName' : "Your Company",
            'IndividualName':"Your Name",
            'PositionName':"Your Position",
            'Role':"your role",
            'DeliveryPoint': "Street",
            'City': "City",
            'PostalCode':"00000",
            'Country': "Your country",
            'ElectronicMailAddress':"your.email@address",
    },

    'OperationsMetadata': {
        'ServerAddress' : "http://localhost/cgi-bin/wps/wps.py",
    },
    'Keywords' : ['GRASS','GIS','WPS'],
}
</PRE>

<P>
In the <TT>ServerSettings</TT> section, the variables are set, which have impact on
the whole server.

<P>
<PRE>
ServerSettings = {
        # NOTE: You have to create this directory manually and set rights, so
        #       the program is able to store data in there 
        'outputPath': '/var/www/wpsoutputs',
        
        #
        # 'outputUrl' - URL of the directory, where the outputs will be stored
        'outputUrl':  'http://192.168.1.31/wpsoutputs',
        
        #
        # tempPath - path to directory, where temporary data will be stored.
        # NOTE: the pywps has to have rights, to create directories and files
        #       in this directory
        'tempPath': '/tmp',
        
        #
        # maxOperations - maximum number of operations, which is allowed to low
        # on this server at ones 
        # default = 1
        'maxOperations':1,
        
        #
        # maxSize: maximum input file size in bytes
        # NOTE: maximum file size is 5MB, no care, if this number is higher
        'maxSize':5242880, # 5 MB
        
        #
        # maxInputParamLength: maximal length of input values
        # NOTE: maximum length of input parameters is 256, no matter, how height
        #       is this number
        'maxInputParamLength':256,
}
</PRE>

<P>

<H2><A NAME="SECTION00062000000000000000">
<TT>etc/grass.py</TT></A>
</H2>

<P>
This file servers for configuration of GRASS GIS environment (if your
processes need one). Everything is stored in <TT>grassenv</TT> structure. 

<P>
<PRE>
grassenv = {
    # PATH in which your modules (processes) should be able the search.
    # Default value:
    'PATH': "/usr/local/grass-6.1.cvs/bin/:/usr/local/grass-6.1.cvs/scripts/:\
    /usr/bin/:/bin/:",
    
    # Add eventually some other path, in which should GRASS search for modules
    'GRASS_ADDON_PATH': "",
    
    # Version of GRASS, you are using
    'GRASS_VERSION': "6.1.cvs",
    
    # GRASS_PERL, where is your PERL bin installed
    'GRASS_PERL': "/usr/bin/perl",
    
    # GRASS_GUI should be always "text" unless you know, what you are doing
    'GRASS_GUI': "text",
    
    # GISBASE is place, where your GRASS installation is
    'GISBASE': "/usr/local/grass-6.1.cvs",
    
    # LD_LIBRARY_PATH
    'LD_LIBRARY_PATH':"/usr/local/grass-6.1.cvs/lib",
    
    # HOME has to be set
    'HOME':"/var/www",
}
</PRE>

<P>

<H2><A NAME="SECTION00063000000000000000"></A>
<A NAME="testing"></A>
<BR>
Testing after installation
</H2>
For test, just run
<TT>wps.py</TT> in your command line:

<P>
<PRE>
$ ./wps.py
Content-type: text/xml

&lt;?xml version="1.0" ?&gt;
&lt;ExceptionReport version="1.0.0" xmlns="http://www.opengis.net/ows" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
        &lt;Exception exceptionCode="MissingParameterValue" locator="request"/&gt;
&lt;/ExceptionReport&gt;
</PRE>

<P>
If you got some other message, like e.g.:

<P>
<PRE>
Traceback (most recent call last):
  File "trunk/index.py", line 53, in ?
    from Wps import wpsexceptions
  File "/home/jachym/prog/pywps/trunk/Wps/wpsexceptions.py", line 8, in ?
    from xml.dom.minidom import Document
ImportError: No module named xml.dom.minidom
</PRE>

<P>
Than something is wrong with your Python installation or with the program.
This message means, that the xml.dom.minidom package is not installed in
your system.

<P>

<H1><A NAME="SECTION00070000000000000000"></A>
<A NAME="processes"></A>
<BR>
Add your own processes
</H1>

<P>
<BR>
NOTE: This section has changed from previous stable 1.0.0 version. The
processes, you defined for 1.0.0 branch should work for 2.0.0 branch too.
<P>
<BR>


<P>
All processes are stored in the <TT>processes</TT> directory. Put your file
e.g. <TT>myprocess.py</TT> in there. Several example processes are
distributed along with PyWPS source code.

<P>
Process is python class derived from prepared <TT>WPSProcess</TT> class in
<TT>pywps.Wps</TT> package. In it <TT>__init__</TT> method,
process metadata, inputs and outpus are defined and in
<TT>execute(self)</TT> method, own computation is performed.

<P>
It is possible also to add as many your functions, as you wish.

<P>

<H2><A NAME="SECTION00071000000000000000">
Process initialization and configuration</A>
</H2>
First of all, you have to add name of your process to
<TT>pywps/processes/__init__.py</TT> file. Then you can start to edit
the process file it's self.

<P>
<PRE>
01 # importing necessary files
02 import pywps.Wps.WPSProcess
03 
04 class Process(WPSProcess):
05      def __init__(self):
06          WPSProcess.__init__(self,
07                Identifier="ogr2ogr",
18                Title="ogr2ogr interface",
19                Abstract="Convert vector file to another format",
10                processVersion = "0.2",
11                statusSupported="true",
12                storeSupported="true")
</PRE>

<P>
We defined new process called <TT>ogr2ogr</TT>. The process is allowed to
store it's output data on the server (<TT>storeSupported</TT>) and it is also possible to run it in
asynchronous mode (<TT>statusSupported</TT>).

<P>
Eventually optional attributes can be found in the table 38 - "Parts of
ExecuteResponse data structure" in the WPS reference
document<A NAME="tex2html26"
  HREF="#foot307"><SUP><SPAN CLASS="arabic">11</SPAN></SUP></A>. It is also possible to redefine some
variable later, after initialization:

<P>
<PRE>
13
14          self.Title="ogr2ogr interface"
15
</PRE>

<P>

<H4><A NAME="SECTION00071010000000000000">
Metadata defition</A>
</H4> is stored in array <TT>self.Metadata</TT> in
<TT>__init__</TT> method. You can add new Medatada using
<TT>self.AddMetadata()</TT> method:
<PRE>
            self.AddMetadata(Identifier="point",type="point",
                            textContent="Click in the map")
</PRE>

<P>
This code will produce in DescribeProcess responce document following
element:
<PRE>
...
&lt;ows:Metadata Identifier="point" type="point"&gt;
    Click in the map
&lt;/ows:Metadata&gt;
...
</PRE>

<P>

<H3><A NAME="SECTION00071100000000000000">
Data Inputs</A>
</H3>
Data inputs are stored in <TT>self.Inputs</TT> array. To add inputs to
your process, you should use methods defined in <TT>WPSProcess</TT> class.

<P>
Four types of data inputs are defined:

<UL>
<LI>Literal Input - Basic literal input - single number or text
    value
</LI>
<LI>ComplexValue Input  - Mostly vector file embded in input XML
    request
</LI>
<LI>ComplexValueReference Input - URL to location, where the process
    is supposed to get the input data.
</LI>
<LI>BoundingBox Input - Coordinates for lower-left and upper-right
    corner.
</LI>
</UL>

<P>
ComplexValue and ComplexValueReference defined on the same way - PyWPS is
able to guess, if the input data are reference (link) to some map or raw
data directly.

<P>

<H4><A NAME="SECTION00071110000000000000">
LiteralInput</A>
</H4>

<P>
Basic type of data input is <TT>LiteralInput</TT> type. To define
LiteralInput the easy way, you should use <TT>AddLiteralInput</TT> method:

<P>
<PRE>
20
21          self.AddLiteralInput(Identifier="value",
                                 Title="Value to be added",
                                 type=type(0))
</PRE>

<P>
Above example will add new input with identifier <TT>value</TT> of type
integer. Examples of other possibilities of LiteralInputs and resulting
part of XML are folowing:

<P>

<H5><A NAME="SECTION00071111000000000000">
Example of any allowed input value (default)</A>
</H5>
<PRE>
self.AddLiteralInput(Identifier="someinput", 
                     Title="Some Input", 
                     allowedvalues='*')

...
  &lt;Input&gt;
    &lt;ows:Identifier&gt;someinput&lt;/ows:Identifier&gt;
    &lt;ows:Title&gt;Some Input&lt;/ows:Title&gt;
    &lt;ows:Abstract/&gt;
        &lt;LiteralData&gt;
            &lt;SupportedUOMs defaultUOM="m"&gt;
                &lt;ows:UOM&gt;m&lt;/ows:UOM&gt;
            &lt;/SupportedUOMs&gt;
            &lt;ows:AnyValue/&gt;
        &lt;/LiteralData&gt;
    &lt;MinimumOccurs&gt;1&lt;/MinimumOccurs&gt;
  &lt;/Input&gt;
...
</PRE>

<P>

<H5><A NAME="SECTION00071112000000000000">
Example of specified list (with range) of allowed inputs</A>
</H5>

<P>
Following example will define input with specified list of values: Only
values 20, 30, everything between 40-100 and 110 will be accepted:
<PRE>
self.AddLiteralInput(Identifier="someinput",
                     Title="Some Input",
                     allowedvalues=[20,30,[40,100],110])

...
  &lt;Input&gt;
    &lt;ows:Identifier&gt;someinput&lt;/ows:Identifier&gt;
    &lt;ows:Title&gt;Some Input&lt;/ows:Title&gt;
    &lt;ows:Abstract/&gt;
    &lt;LiteralData&gt;
    	&lt;SupportedUOMs defaultUOM="m"&gt;
        &lt;ows:UOM&gt;m&lt;/ows:UOM&gt;
        &lt;/SupportedUOMs&gt;
        &lt;AllowedValues&gt;
            &lt;Value&gt;20&lt;/Value&gt;
            &lt;Value&gt;30&lt;/Value&gt;
            &lt;Range&gt;
                &lt;MinimumValue&gt;40&lt;/MinimumValue&gt;
                &lt;MaximumValue&gt;100&lt;/MaximumValue&gt;
            &lt;/Range&gt;
            &lt;Value&gt;110&lt;/Value&gt;
        &lt;/AllowedValues&gt;
    &lt;/LiteralData&gt;
    &lt;MinimumOccurs&gt;1&lt;/MinimumOccurs&gt;
  &lt;/Input&gt;
...
</PRE>

<P>
For further documentation, refere example processes distributed with the
source code as well as <TT>pydoc&nbsp;pywps/wps/process.py</TT>. This help is
also available in
<TT>process.html</TT><A NAME="tex2html28"
  HREF="#foot308"><SUP><SPAN CLASS="arabic">12</SPAN></SUP></A> file distributed along with PyWPS
source code.

<P>

<H4><A NAME="SECTION00071120000000000000">
ComplexInput</A>
</H4>
If the request comes as HTTP GET, it is assumed, that the input is only
reference to some map. If it comes as HTTP POST, PyWPS tryes to guess, if
the client is sending URL to source of the data or if the input data are
part of input XML request (e.g. as GML file). So, you, as a process coder
do not have to take care on this:

<P>
<PRE>
self.AddComplexInput(Indentifier="inputmap",
      Title="Input map, which should be processed",
      Formats=["text/xml","image/tiff"])
...
    &lt;Input&gt;
        &lt;ows:Identifier&gt;input&lt;/ows:Identifier&gt;
        &lt;ows:Title&gt;Input raster map&lt;/ows:Title&gt;
        &lt;ows:Abstract/&gt;
        &lt;ComplexData defaultFormat="image/tiff"&gt;
            &lt;SupportedComplexData&gt;
                &lt;Format&gt;image/tiff&lt;/Format&gt;
                &lt;Format&gt;text/xml&lt;/Format&gt;
            &lt;/SupportedComplexData&gt;
        &lt;/ComplexData&gt;
        &lt;MinimumOccurs&gt;1&lt;/MinimumOccurs&gt;
    &lt;/Input&gt;
</PRE>

<P>

<H4><A NAME="SECTION00071130000000000000">
BoundingBox Input</A>
</H4>
With bounding box, you can define two coordinate pairs, if you have to.

<P>
<PRE>
self.AddBondingBoxInput(Identifier="bbox",
        Title="BBox input")
</PRE>

<P>

<H3><A NAME="SECTION00071200000000000000">
Data Outputs</A>
</H3>
Again four types of output are defined:

<UL>
<LI>Literal Output
</LI>
<LI>ComplexValue Output
</LI>
<LI>ComplexValue Reference
</LI>
<LI>BoundingBox Output
</LI>
</UL>

<P>
Data outputs can be defined on similar way, using similar methods:

<P>

<H4><A NAME="SECTION00071210000000000000">
LiteralOutput</A>
</H4>
<PRE>
self.AddLiteralOutput(Identifier="litoutput",
                     Title="Resulting output value")

...
  &lt;Output&gt;
    &lt;ows:Identifier&gt;litoutput&lt;/ows:Identifier&gt;
    &lt;ows:Title&gt;Resulting output value&lt;/ows:Title&gt;
    &lt;ows:Abstract/&gt;
    &lt;LiteralOutput&gt;
      &lt;SupportedUOMs defaultUOM="m"&gt;
        &lt;ows:UOM&gt;m&lt;/ows:UOM&gt;
      &lt;/SupportedUOMs&gt;
    &lt;/LiteralOutput&gt;
  &lt;/Output&gt;
...
</PRE>

<P>

<H4><A NAME="SECTION00071220000000000000">
ComplexValue and ComplexValueReference Output</A>
</H4>
To the oposite of data Inputs, Outputs can distinguish between ComplexValue
output and ComplexValueReference. ComplexValue is directly embed into the
output XML document and ComplexValueReference is stored on the server and
only URL pointing the the file is refering to it. In general, vector files
in GML format can be easy embed to the output XML, TIFF raster files is
better to leave on the server.

<P>
<PRE>
self.AddComplexReferenceOutput(Identifier="output",
                Title="Resulting output map",
                Formats=["image/tiff"])

...
  &lt;Output&gt;
    &lt;ows:Identifier&gt;output&lt;/ows:Identifier&gt;
    &lt;ows:Title&gt;Resulting output map&lt;/ows:Title&gt;
    &lt;ows:Abstract/&gt;
    &lt;ComplexOutput defaultFormat="image/tiff"&gt;
      &lt;SupportedComplexData&gt;
        &lt;Format&gt;image/tiff&lt;/Format&gt;
      &lt;/SupportedComplexData&gt;
    &lt;/ComplexOutput&gt;
  &lt;/Output&gt;
...
</PRE>

<P>

<H4><A NAME="SECTION00071230000000000000">
BoundingBox Output</A>
</H4>
Beside LiteralValue and ComplexValue, BoundingBoxValue is also defined. 
The coordinates are stored in array of four members:

<P>
<PRE>
self.GetInputValue("bboxinput")
[0,0,100,100]
</PRE>

<P>

<P><P>
<BR>

<P>
So on our <TT>ogr2ogr</TT> process, we have to define three types of input:
<TT>ComplexValue</TT> of input vector file and EPSG codes of target and
source files:

<P>
<PRE>
16      self.AddComplexInput(Identifier="inputmap",
17          Title ="Input vector file",
18          Abstract = "Input vector file to be converted",
19          Formats=["text/xml"])
20
21      self.AddLiteralInput(Identifier="sepsg",
22          Title="Source EPSG",
23          Abstract="Source EPSG code",
24          value=4326)
</PRE>

<P>
And we also define two outputs: ComplexValueReference and ComplexValue
type.

<P>
<PRE>
25      self.AddComplexOutput(Identifier="outputmap",
26          Title ="Input vector file",
27          Abstract = "Input vector file to be converted",
28
29      self.LiteralOutput(Identifier="sepsg",
30          Title="Source EPSG",
31          Abstract="Source EPSG code",
32          value=4326)
</PRE>

<P>

<H2><A NAME="SECTION00072000000000000000">
Process Programming</A>
</H2>

<P>
The process must be defined in the <TT>execute(self)</TT> function. You can
access the input values via <TT>self.GetInputValue(Identifier)</TT> method.

<P>

<P>
<BR>
NOTE: Usage of the old method, accessing the values via
<TT>self.Inputs[index]['value']</TT> or via <TT>self.DataInputs</TT> array
is possible, but should not be used.
<P>
<BR>


<P>
Also variable <TT>self.grassenv</TT> will be in your process at your
service. This dictionary stores environment variables used by GRASS GIS,
such se <TT>LOCATION_NAME</TT> or <TT>MAPSET</TT>.

<P>
Output values should be set using <TT>self.SetOutputValue(Identifier,
value)</TT> method.

<P>

<P>
<BR>
NOTE: Usage of the old methods of output values setting, directly to 
<TT>self.Outputs[index]['value']</TT> variable or to
<TT>self.DataOutputs['identifier']</TT> dictionary, is possible, but should
better not be used.
<P>
<BR>


<P>
If you need to execute some shell command, you should use
<TT>self.Cmd(command,["string for standard input"])</TT> instead of e.g.
<TT>os.system()</TT> or <TT>os.popen()</TT> functions.

<P>
<PRE>
33
35      def execute(self):
36          
37          #
38          # calculation
39          #
30          self.Cmd("""ogr2ogr -s_srs "+init=epsg:4326" -t_srs \
31          "+init=epsg:2065" %s output.file""" % (self.GetInputValue("inputmap")))
32         #
43         # setting results
44         #
45         self.SetOutputValue("outputmap","output.file")
46         self.SetOutputValue("sepsg","4326")
47
48         return
</PRE>

<P>

<H3><A NAME="SECTION00072100000000000000">
Error handling</A>
</H3>

<P>
At the end of the <TT>execute</TT> function, <TT>None</TT> value should be returned. Any other 
value means, that the calculation will be stopped and error report will be returned back to the client.

<P>

<H3><A NAME="SECTION00072200000000000000">
Using standard in- and output with external commands</A>
</H3>
The <TT>self.Cmd()</TT> accepts <TT>input</TT> parameter, wich is a text
string, which is directred to standard input of the command:

<P>
<PRE>
    result = self.Cmd(cmd="wc -c",
             input="calculate number of characters for this sentence")

    # result[0].split()
</PRE>

<P>
<TT>self.Cmd()</TT> returns list of lines from the programms standard
output to the process:

<P>
<PRE>
    for line in self.Cmd("ls -l"):
        # do some operations of list of files
        pass
</PRE>

<P>

<H2><A NAME="SECTION00073000000000000000">
GRASS specific notes</A>
</H2>

<P>
Special class for GRASS GIS is defined too, which has functions and
variables specific to this program. The process, in which should use GRASS
modules should be defined as follows:

<P>
<PRE>
# importing necessary files
import pywps.Wps.GRASSWPSProcess

class Process(GRASSWPSProcess):
     def __init__(self):
         GRASSWPSProcess.__init__(self,
               Identifier="spearpath",
               Title="Spearfish path searching",
               Abstract="Find the shortest path on the roads map on Spearfish dataset",
               processVersion = "0.2",
               statusSupported="true",
               storeSupported="true",
               # grassLocation="/var/www/spearfish60/" # work on existing location)
</PRE>

<P>
By default, <TT>self.grassLocation</TT><A NAME="tex2html29"
  HREF="#foot311"><SUP><SPAN CLASS="arabic">13</SPAN></SUP></A> 
 variable is set to <TT>None</TT>,
which means, that temporary location will be created and after the
calculation is done, it will be deleted again. You can set this while
process initialization or
later<A NAME="tex2html30"
  HREF="#foot312"><SUP><SPAN CLASS="arabic">14</SPAN></SUP></A>.

<P>
<TT>WPSProcess</TT> class provides special method
<TT>self.GCmd(command_string)</TT>, which tryes to catch output from GRASS
modules, especially progress information inidcated by percent done. Method
<TT>GCmd()</TT> stores the output of GRASS modules to <TT>self.status</TT>
variable, so if the process is running assynchronously, client application
can track the progress of each module directly.

<P>
<PRE>
    def execute(self):
        """
        This function serves like simple GRASS - python script

        It returns None, if process succeed or String if process failed
        """
        self.GCmd("g.region -d")


        # v.net.path reads from standard input
        self.GCmd("v.net.path in=roads out=path","0 %s %s %s %s" % (self.GetInputValue('x1'),
                self.GetInputValue('y1'),
                self.GetInputValue('x2'),
                self.GetInputValue('y2')))

        self.GCmd("v.out.ogr format=GML input=path dsn=out.xml olayer=path.xml")

        if "out.xml" in os.listdir(os.curdir):
            shutil.copy("out.xml","out2.xml")
            self.SetOutputValue('outputReference',"out.xml")
            self.SetOutputValue('outputData',"out2.xml")
            return
        else:
            return "Ouput file not created!"
</PRE>

<P>
It is also possible to run GRASS modules using python's
<TT>os.system()</TT> or <TT>os.popen()</TT> function.  Before you do so, it
is important to import the <TT>os</TT> python package (usually one of the
first lines in the file). This approach might not be the best, but it is
the simplest one. Feel free to use any other low-end functions.

<P>
Unfortunately, the GRASS modules are very verbose. Some messages are
written to STDOUT, some to STDERR. The STDERR will be stored in the error
file of your web server. But you have to "catch" the messages, sent to
STDOUT. This can be done e.g. by using "<SPAN CLASS="MATH"><IMG
 WIDTH="59" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$1&gt;\&amp;2$"></SPAN>" statement (redirecting
STDOUT to STDERR in shell):

<P>
<PRE>
os.system("""
    echo "Rekni jim drazi, tatko, za to nic nedas."  &gt;&amp;2
""")
</PRE>

<P>
You can avoid this problem using formentioned <TT>self.GCmd()</TT> method.

<P>

<H1><A NAME="SECTION00080000000000000000">
Testing your new process</A>
</H1>

<P>
To test your PyWPS installation, you run it either as Webserver
cgi-application or in the command line directly. It is always good to start
with the command line test, so do not have to check <TT>error.log</TT> of
the web server.

<P>

<UL>
<LI>GetCapabilities request (webserver)
<PRE>
./wps.py "service=wps&amp;request=getcapabilities"

wget -nv -q -O - "http://localhost/cgi-bin/wps.py?\
    service=Wps&amp;request=getcapabilities"
</PRE>

<P>
</LI>
<LI>DescribeProcess request:
<PRE>
./wps.py "version=0.4.0&amp;service=Wps&amp;request=DescribeProcess&amp;\
    Identifier=your_process"

wget -nv -q -O - "http://localhost/cgi-bin/wps.py?\
    version=0.4.0&amp;service=Wps&amp;request=DescribeProcess&amp;\
    Identifier=your_process"
</PRE>

<P>
</LI>
<LI>Execute request:
<PRE>
./wps.py "version=0.4.0&amp;service=Wps&amp;\
    request=Execute&amp;Identifier=your_process&amp;\
    datainputs=input1,value1,input2,value2"

wget -nv -q -O - "http://localhost/cgi-bin/wps.py?\
    version=0.4.0&amp;service=Wps&amp;\
    request=Execute&amp;Identifier=your_process&amp;\
    datainputs=input1,value1,input2,value2" \
</PRE>

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION00090000000000000000">
Using PyWPS</A>
</H1>

<H2><A NAME="SECTION00091000000000000000">
Input</A>
</H2>

<P>
To get response from PyWPS you have to formulate appropriate query string first. You can use HTTP GET style or HTTP POST style.

<P>
HTTP GET style is standard URL, with all parameters in one line. You can not set any <TT>ComplexValue</TT> data in your process via HTTP GET. Example:

<P>
<PRE>
wget -nv -q -O - --post-data="version=0.4.0&amp;service=Wps&amp;\
        request=Execute&amp;Identifier=your_process&amp;\
        datainputs=input1,value1,input2,value2"\
        "http://localhost/cgi-bin/wps.py"
</PRE>

<P>
In HTTP POST style, you send one "request" parameter, which contains XML input. The XML file can contain also included ComplexValue data, e.g. GML file. Example:

<P>
<PRE>
wget --post-file=execute-post.txt \
        "http://localhost/pywps/wps.py" -O - -nv -q
</PRE>

<P>
The <TT>execute-post.txt</TT> file can look like follows:
<PRE>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Execute service="WPS" version="0.4.0" store="false" status="false"
xmlns="http://www.opengeospatial.net/wps"
xmlns:ows="http://www.opengeospatial.net/ows"
xmlns:xlink="http://www.w3.org/1999/xlink"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.opengeospatial.net/wps/wpsDescribeProcess.xsd"&gt;
    &lt;ows:Identifier&gt;searchpath&lt;/ows:Identifier&gt;
    &lt;DataInputs&gt;
        &lt;Input&gt;
            &lt;ows:Identifier&gt;streetmap&lt;/ows:Identifier&gt;
            &lt;ows:Title&gt;The map&lt;/ows:Title&gt;
            &lt;ows:ComplexValue&gt;
                &lt;Value&gt;
&lt;ogr:FeatureCollection
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://ogr.maptools.org/ donut.xsd"
     xmlns:ogr="http://ogr.maptools.org/"
     xmlns:gml="http://www.opengis.net/gml"&gt;
  &lt;gml:boundedBy&gt;
    &lt;gml:Box&gt;
      &lt;gml:coord&gt;&lt;gml:X&gt;4.263256414560601e-14&lt;/gml:X&gt;
        &lt;gml:Y&gt;-70.71067811865474&lt;/gml:Y&gt;&lt;/gml:coord&gt;
      &lt;gml:coord&gt;&lt;gml:X&gt;141.4213562373095&lt;/gml:X&gt;
      &lt;gml:Y&gt;70.71067811865474&lt;/gml:Y&gt;&lt;/gml:coord&gt;
    &lt;/gml:Box&gt;
  &lt;/gml:boundedBy&gt;                      
  &lt;gml:featureMember&gt;
    &lt;ogr:donut fid="F0"&gt;
      &lt;ogr:geometryProperty&gt;&lt;gml:LineString&gt;&lt;gml:coordinates&gt;
      70.710678118654755,70.710678118654741,0 141.42135623730951,0.0,
      0 70.710678118654741,-70.710678118654741,0 0.000000000000043,
      0.000000000000057,0 70.710678118654755,
      70.710678118654741,0&lt;/gml:coordinates&gt;
      &lt;/gml:LineString&gt;&lt;/ogr:geometryProperty&gt;
    &lt;/ogr:donut&gt;
  &lt;/gml:featureMember&gt;
  &lt;gml:featureMember&gt;
    &lt;ogr:donut fid="F0"&gt;
      &lt;ogr:geometryProperty&gt;&lt;gml:LineString&gt;&lt;gml:coordinates&gt;50.000000000000014,
      0.000000000000021,0 71.213203435596427,-21.213203435596419,0 
      92.426406871192853,0.0,0 71.213203435596427,21.213203435596423,0 
      50.000000000000014,0.000000000000021,0&lt;/gml:coordinates&gt;
      &lt;/gml:LineString&gt;&lt;/ogr:geometryProperty&gt;
    &lt;/ogr:donut&gt;
  &lt;/gml:featureMember&gt;
&lt;/ogr:FeatureCollection&gt;
                &lt;/Value&gt;
            &lt;/ows:ComplexValue&gt;
        &lt;/Input&gt;

        &lt;Input&gt;
            &lt;ows:Identifier&gt;x1&lt;/ows:Identifier&gt;
            &lt;ows:LiteralValue&gt;591679.31&lt;/ows:LiteralValue&gt;
        &lt;/Input&gt;
        &lt;Input&gt;
            &lt;ows:Identifier&gt;y1&lt;/ows:Identifier&gt;
            &lt;ows:LiteralValue&gt;4927205.07&lt;/ows:LiteralValue&gt;
        &lt;/Input&gt;
        &lt;Input&gt;
            &lt;ows:Identifier&gt;x2&lt;/ows:Identifier&gt;
            &lt;ows:LiteralValue&gt;608642.625&lt;/ows:LiteralValue&gt;
        &lt;/Input&gt;
        &lt;Input&gt;
            &lt;ows:Identifier&gt;y2&lt;/ows:Identifier&gt;
            &lt;ows:LiteralValue&gt;4915876.31&lt;/ows:LiteralValue&gt;
        &lt;/Input&gt;
    &lt;/DataInputs&gt;
&lt;/Execute&gt;
</PRE>

<P>
You can see, that there are 4 inputs in this process: 

<P>

<OL>
<LI>ComplexValue GML File 
</LI>
<LI>x1 coordinate 
</LI>
<LI>y1 coordinate 
</LI>
<LI>x2 coordinate 
</LI>
<LI>y2 coordinate 
    
</LI>
</OL>
<H2><A NAME="SECTION00092000000000000000">
Output</A>
</H2>

<P>
The output from PyWPS can be either XML file or results of processes directly. In default configuration, no files are stored on the server, resulting values (maps) are 
    returned to the client. If you want to return XML file with outputs
    encoding, you have to enable it in you process configuration with
    option <TT>storeSupported</TT>:

<P>
<PRE>
    self.storeSupported = "true"
</PRE>

<P>
And you have to call the PyWPS with "store=true" option:

<P>
<PRE>
    version=0.4.0&amp;service=Wps&amp;request=Execute&amp;Identifier=your_process&amp;\
                    datainputs=input1,value1,input2,value2&amp;store=true
</PRE>

<P>
Or in XML input:

<P>
<PRE>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Execute service="WPS" version="0.4.0" store="true" status="false"
xmlns="http://www.opengeospatial.net/wps"
xmlns:ows="http://www.opengeospatial.net/ows"
xmlns:xlink="http://www.w3.org/1999/xlink"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.opengeospatial.net/wps/wpsDescribeProcess.xsd"&gt;

...
</PRE>

<P>
This will cause PyWPS to look after <TT>self.status</TT> array in your process in form form 
<PRE>
    self.status = ["Message", Percent_Done]
</PRE>
and generate XML file in statusLocation with this embed message. E.g.

<P>
<PRE>
    self.status = ["Generating raster map", 50]
</PRE>
or better
<PRE>
    self.SetStatus("Generarting raster map", 50)
</PRE>

<P>
will become

<P>
<PRE>
...
    &lt;Status&gt;
            &lt;ProcessStarted message="Generating raster map" percentCompleted="50"/&gt;
    &lt;/Status&gt;
...
</PRE>

<P>

<P>

<H1><A NAME="SECTION000100000000000000000">
Example process: <TT>addvalue</TT></A>
</H1>
    This sample process describes how to made your own WPS processes. Purpose of this process is:
    
<UL>
<LI>Download input raster map from some server
</LI>
<LI>Convert it to integer values
</LI>
<LI>Add input value to each raster cell
</LI>
<LI>Convert raster to vector
</LI>
<LI>Export raster to TIFF and vector to GML. Vector file will be embed ot output XML file.
    
</LI>
</UL>
    <PRE>
"""

pywps process example:

addvalue: Adds some value to raster map
"""
# Author:	Jachym Cepicky
#        	http://les-ejk.cz
# Lince:        GNU/GPL
# 
# Copyright (C) 2006 Jachym Cepicky

import os,time,string,sys,shutil
from pywps.Wps.process import GRASSWPSProcess

class Process (GRASSWPSProcess):
    #
    # Initialization
    #
    def __init__(self):
        GRASSWPSProcess.__init__(self,
                            Identifier="Addvalue",
                    Title="Add some value to input raster map",
                            processVersion = "0.2",
                            statusSupported="true",
                            storeSupported="true",
                            grassLocation = None)


        #
        # Inputs
        self.AddComplexInput(Identifier="input",
                            Title="Input raster map", 
                            Formats=["image/tiff"])
        self.AddLiteralInput(Identifier="value",
                            Title="Value to be added",
                            type=type(0))

        #
        # Outputs
        self.AddComplexReferenceOutput(Identifier="output",
                            Title="Resulting output map",
                            Formats=["image/tiff"])
    #
    # Execute part of the process
    #
    def execute(self):
        """
        This function
            1) Imports the raster map
            2) runs r.mapcalc out=in+value
            3) Exports the raster map
            4) returns the new file name or 'None' if something went wrong
        """

        # import of the data
        self.SetStatus("Importing data")
        if not self.GCmd("r.in.gdal -o in=%s out=input" %\
                (self.GetInputValue("input"))):
            return "Could not import raster file"
        self.SetStatus("Importing data",10)

        # compositing 3 bands to one raster file
        for gdalinfoln in os.popen("gdalinfo %s" %\
                (self.GetInputValue("input"))):
            if gdalinfoln.split()[0] == "Band" and gdalinfoln.split()[1] == "3":
                self.GCmd("""g.region rast=input.red """)
                self.GCmd("r.composite r=input.red b=input.blue g=input.green out=input")

        # region setting
        self.GCmd("""g.region rast=input""")    

        # adding the value
        self.SetStatus("Adding new value to raster map",50)
        self.GCmd("r.mapcalc output='input+%f'" % float(self.GetInputValue('value')))

        # output
        self.SetStatus("Raster file export", 90)
        self.GCmd("r.out.gdal type=Int32 in=output out=%s" % "output.tif")

        # setting output values
        self.SetOutputValue("output","output.tif")
        if "output.tif" in os.listdir(os.curdir):
            return  # OK
        else:
            return "Output file not created!" # FAILED
        """
</PRE>

<P>

<H1><A NAME="SECTION000110000000000000000">
KVP request encoding of <TT>addvalue</TT></A>
</H1>
    This process can be lunched with URL:
<BR>    http://localhost/cgi-bin/wps.py?service=wps&amp;version=0.4.0&amp;identifier=addvalue&amp;request=execute&amp;<SPAN CLASS="MATH"><IMG
 WIDTH="13" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\backslash$"></SPAN>
<BR>
datainputs=input,http://localhost/data/raster.tif,value,250&amp;status=true&amp;store=true

<P>

<H1><A NAME="SECTION000120000000000000000">
XML request encoding <TT>addvalue</TT></A>
</H1>
<PRE>
request=&lt;?xml version='1.0' encoding='UTF-8' standalone='yes'?&gt;
&lt;Execute service='wps' version='0.4.0' store='true' status='false'
    xmlns="http://www.opengeospatial.net/wps"
    xmlns:ows="http://www.opengeospatial.net/ows"&gt;
&lt;ows:Identifier&gt;addvalue&lt;/ows:Identifier&gt;
&lt;DataInputs&gt;
    &lt;Input&gt;
        &lt;ows:Identifier&gt;input&lt;/ows:Identifier&gt;
        &lt;ComplexValueReference reference='http://localhost/wps/data/soils.tif' /&gt;
    &lt;/Input&gt;
    &lt;Input&gt;
        &lt;ows:Identifier&gt;value&lt;/ows:Identifier&gt;
        &lt;LiteralValue&gt;250&lt;/LiteralValue&gt;
    &lt;/Input&gt;
    &lt;!-- Input&gt;
        &lt;ows:Identifier&gt;bbox&lt;/ows:Identifier&gt;
        &lt;BoundingBoxValue&gt;
            &lt;BoundingBox&gt;
                &lt;LowerCorner&gt;-1 -1&lt;/LowerCorner&gt;
                &lt;UpperCorner&gt;10 10&lt;/UpperCorner&gt;
            &lt;/BoundingBox&gt;
        &lt;/BoundingBoxValue&gt;
    &lt;/Input --&gt;
&lt;/DataInputs&gt;
&lt;/Execute&gt;
</PRE>

<P>

<H1><A NAME="SECTION000130000000000000000">
About this document ...</A>
</H1>
 <STRONG>Implementation of OGC's WPS standard: PyWPS</STRONG><P>
This document was generated using the
<A HREF="http://www.latex2html.org/"><STRONG>LaTeX</STRONG>2<tt>HTML</tt></A> translator Version 2002-2-1 (1.71)
<P>
Copyright &#169; 1993, 1994, 1995, 1996,
Nikos Drakos, 
Computer Based Learning Unit, University of Leeds.
<BR>
Copyright &#169; 1997, 1998, 1999,
<A HREF="http://www.maths.mq.edu.au/~ross/">Ross Moore</A>, 
Mathematics Department, Macquarie University, Sydney.
<P>
The command line arguments were: <BR>
 <STRONG>latex2html</STRONG> <TT>-split 0 pywps-howto.tex</TT>
<P>
The translation was initiated by Jachym Cepicky on 2007-10-02
<BR><HR><H4>Footnotes</H4>
<DL>
<DT><A NAME="foot297">... Umwelt</A><A
 HREF="pywps-howto.html#tex2html1"><SUP><SPAN CLASS="arabic">1</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html2"
  HREF="http://dbu.de">http://dbu.de</A></TT>

</DD>
<DT><A NAME="foot298">...
GDF-Hannover</A><A
 HREF="pywps-howto.html#tex2html3"><SUP><SPAN CLASS="arabic">2</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html4"
  HREF="http://gdf-hannover.de">http://gdf-hannover.de</A></TT>

</DD>
<DT><A NAME="foot299">...
Sensing</A><A
 HREF="pywps-howto.html#tex2html5"><SUP><SPAN CLASS="arabic">3</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html6"
  HREF="http://www.bnhelp.cz">http://www.bnhelp.cz</A></TT>

</DD>
<DT><A NAME="foot300">...
Cepicky</A><A
 HREF="pywps-howto.html#tex2html7"><SUP><SPAN CLASS="arabic">4</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html8"
  HREF="http://les-ejk.cz">http://les-ejk.cz</A></TT>

</DD>
<DT><A NAME="foot301">...
Consortium</A><A
 HREF="pywps-howto.html#tex2html9"><SUP><SPAN CLASS="arabic">5</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html10"
  HREF="http://www.opengeospatial.org/standards/requests/28">http://www.opengeospatial.org/standards/requests/28</A></TT>

</DD>
<DT><A NAME="foot40">...
GIS</A><A
 HREF="pywps-howto.html#tex2html11"><SUP><SPAN CLASS="arabic">6</SPAN></SUP></A></DT>
<DD>http://grass.itc.it

</DD>
<DT><A NAME="foot302">...
list</A><A
 HREF="pywps-howto.html#tex2html15"><SUP><SPAN CLASS="arabic">7</SPAN></SUP></A></DT>
<DD>http://wald.intevation.org/mailman/listinfo/pywps-develPyWPS
- development list

</DD>
<DT><A NAME="foot303">...
bugtracker</A><A
 HREF="pywps-howto.html#tex2html16"><SUP><SPAN CLASS="arabic">8</SPAN></SUP></A></DT>
<DD>http://wald.intevation.org/tracker/?atid=174&amp;group_id=22&amp;func=browsePyWPS
Bug tracker

</DD>
<DT><A NAME="foot93">...
homepage</A><A
 HREF="pywps-howto.html#tex2html22"><SUP><SPAN CLASS="arabic">9</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html23"
  HREF="http://pywps.wald.intevation.org">http://pywps.wald.intevation.org</A></TT>

</DD>
<DT><A NAME="foot304">...
0.4.0</A><A
 HREF="pywps-howto.html#tex2html24"><SUP><SPAN CLASS="arabic">10</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html25"
  HREF="http://www.opengeospatial.org/standards/requests/28">http://www.opengeospatial.org/standards/requests/28</A></TT>

</DD>
<DT><A NAME="foot307">...
document</A><A
 HREF="pywps-howto.html#tex2html26"><SUP><SPAN CLASS="arabic">11</SPAN></SUP></A></DT>
<DD><TT><A NAME="tex2html27"
  HREF="http://www.opengeospatial.org/standards/requests/28">http://www.opengeospatial.org/standards/requests/28</A></TT>

</DD>
<DT><A NAME="foot308">...process.html</A><A
 HREF="pywps-howto.html#tex2html28"><SUP><SPAN CLASS="arabic">12</SPAN></SUP></A></DT>
<DD>http://wald.intevation.org/plugins/scmsvn/viewcvs.php/*checkout*/trunk/doc/process.html?rev=369&amp;root=pywpsDocumentation
to process.py module

</DD>
<DT><A NAME="foot311">...self.grassLocation</A><A
 HREF="pywps-howto.html#tex2html29"><SUP><SPAN CLASS="arabic">13</SPAN></SUP></A></DT>
<DD>See e.g.
http://grass.itc.it/grass63/manuals/html63_user/helptext.htmlGRASS
manual for details

</DD>
<DT><A NAME="foot312">...
later</A><A
 HREF="pywps-howto.html#tex2html30"><SUP><SPAN CLASS="arabic">14</SPAN></SUP></A></DT>
<DD><TT>self.grassLocation="/path/to/location"</TT>

</DD>
</DL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive"
 SRC="/usr/share/latex2html/icons/nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev_g.png">   
<BR></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Jachym Cepicky
2007-10-02
</ADDRESS>
</BODY>
</HTML>
